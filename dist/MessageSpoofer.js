function f(e){window.enmity.plugins.registerPlugin(e)}function i(...e){return window.enmity.modules.getByProps(...e)}window.enmity.modules.common,window.enmity.modules.common.Constants,window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const r=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const S=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function v(e){return window.enmity.patcher.create(e)}function M(e){return window.enmity.assets.getIDByName(e)}var _="MessageSpoofer",A="1.1.3",N="Change what people say.",E=[{name:"NotMarek",id:"206299359007080450"}],b="#ff0069",C="https://raw.githubusercontent.com/notmarek/enmity-plugins/master/dist/MessageSpoofer.js",D={name:_,version:A,description:N,authors:E,color:b,sourceUrl:C};const P=i("getMessage","getMessages"),k=i("getChannel","getDMFromUserId"),t=v("message-spoofer"),w=i("openLazy"),L=i("_currentDispatchActionType","_subscriptions","_waitQueue"),R={...D,patches:[],onStart(){let e=!1;t.before(w,"openLazy",(a,[o,s])=>{s==="MessageLongPressActionSheet"&&o.then(n=>{let l=n.default;return n.default=function({message:d,user:u,channel:c,canAddNewReactions:y},g){let m=l({message:d,user:u,channel:c,canAddNewReactions:y},g);if(m.props.children.props.children.props.children[1][0].key=="69")return m;let p=m.props.children.props.children.props.children[1][0].type,h=S.createElement(p,{key:"69",onPressRow:T=>{w.hideActionSheet(),r.startEditMessage(`dirty-${c.id}`,d.id,d.content)},message:"Spoof edit",iconSource:M("ic_message_retry")});return m.props.children.props.children.props.children[1].unshift(h),m},n})}),t.before(r,"startEditMessage",(a,o,s)=>{o[0].startsWith("dirty-")?(o[0]=o[0].replace("dirty-",""),e=!0):e=!1}),t.before(r,"editMessage",(a,o,s)=>{if(e){const n=P.getMessage(o[0],o[1]);L.dispatch({type:"MESSAGE_UPDATE",message:{...n,...o[2],edited_timestamp:n.editedTimestamp,mention_roles:n.mentionRoles,mention_everyone:n.mentionEveryone,member:n.author,guild_id:k.getChannel(n.channel_id).guild_id}}),o={}}})},onStop(){t.unpatchAll()}};f(R);
