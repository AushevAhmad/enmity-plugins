function f(n){window.enmity.plugins.registerPlugin(n)}function d(...n){return window.enmity.modules.getByProps(...n)}window.enmity.modules.common,window.enmity.modules.common.Constants,window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets;const r=window.enmity.modules.common.Messages;window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const S=window.enmity.modules.common.React,v=window.enmity.modules.common.Dispatcher;window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking,window.enmity.modules.common.StyleSheet,window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes;function M(n){return window.enmity.patcher.create(n)}var A="MessageSpooofer",C="1.0.0",E="Change what people say.",N=[{name:"NotMarek",id:"206299359007080450"}],_="#ff0069",b={name:A,version:C,description:E,authors:N,color:_};const P=d("getMessage","getMessages"),D=d("getChannel","getDMFromUserId"),t=M("message-spoofer"),l=d("openLazy"),L={...b,patches:[],onStart(){let n=!1;t.before(l,"openLazy",(a,[o,i])=>{i==="MessageLongPressActionSheet"&&(console.log(JSON.stringify(o)),o.then(e=>{let w=e.default;return e.default=function({message:s,user:u,channel:c,canAddNewReactions:y},p){let m=w({message:s,user:u,channel:c,canAddNewReactions:y},p);if(m.props.children.props.children.props.children[1][0].key=="69")return m;let g=m.props.children.props.children.props.children[1][0].type,h=S.createElement(g,{key:"69",onPressRow:R=>{l.hideActionSheet(),r.startEditMessage(`dirty-${c.id}`,s.id,s.content)},message:"Spoof edit",iconSource:582});return m.props.children.props.children.props.children[1].unshift(h),m},e}))}),t.before(r,"startEditMessage",(a,o,i)=>{o[0].startsWith("dirty-")?(o[0]=o[0].replace("dirty-",""),n=!0):n=!1}),t.before(r,"editMessage",(a,o,i)=>{if(n){const e=P.getMessage(o[0],o[1]);v.dirtyDispatch({type:"MESSAGE_UPDATE",message:{type:e.type,tts:e.tts,timestamp:e.timestamp,pinned:e.pinned,mentions:e.mentions,mention_roles:e.mentionRoles,mention_everyone:e.mentionEveryone,member:e.author,id:e.id,flags:e.flags,embeds:e.embeds,edited_timestamp:e.editedTimestamp,content:o[2].content,components:e.components,channel_id:e.channel_id,author:e.author,attachments:e.originalMessage,guild_id:D.getChannel(e.channel_id).guild_id}}),o={}}})},onStop(){t.unpatchAll()}};f(L);
